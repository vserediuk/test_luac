# –ë—ã—Å—Ç—Ä—ã–π –°—Ç–∞—Ä—Ç - Ultra-Aggressive Cleaner

## –ü—Ä–æ—Å—Ç–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
# –û—á–∏—Å—Ç–∫–∞ –±–∞–π—Ç–∫–æ–¥–∞ —Å –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–º–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è–º–∏ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
python3 clean_luajit_bytecode.py input.luac output.luac
```

–ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤–∫–ª—é—á–µ–Ω—ã **–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é** –≤ Steps 15-18!

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```bash
# –°—Ä–∞–≤–Ω–∏—Ç—å —Ä–∞–∑–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ—á–∏—Å—Ç–∫–∏
python3 compare_cleaners.py
```

–í—ã–≤–æ–¥:
```
Strategy                  Size (KB)    Protos   Instructions   LOOPs   
--------------------------------------------------------------------------------
Original                       498.7       61         105115     1102
Standard Clean                 135.2       61          12090      147
Ultra-Aggressive               134.8       61          11986       43
```

## –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π cleaner?

### 1. –£–ø—Ä–æ—â–∞–µ—Ç Control Flow
- JMP chains: `JMP ‚Üí JMP ‚Üí target` —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è `JMP ‚Üí target`
- –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–æ 10 –ø—Ä–æ—Ö–æ–¥–æ–≤

### 2. –†–ê–î–ò–ö–ê–õ–¨–ù–û —É–¥–∞–ª—è–µ—Ç LOOPs üöÄ
- –£–¥–∞–ª—è–µ—Ç LOOPs ‚â§5 –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –±–µ–∑ backward jumps
- –£–¥–∞–ª—è–µ—Ç LOOPs ‚â§2 –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –≤—Å–µ–≥–¥–∞
- –í –±–æ–ª—å—à–∏—Ö prototypes: —É–¥–∞–ª—è–µ—Ç **–í–°–ï** LOOPs –±–µ–∑ backward jumps
- **–†–µ–∑—É–ª—å—Ç–∞—Ç: 96.1% LOOPs —É–¥–∞–ª–µ–Ω–æ!**

### 3. –£–ø—Ä–æ—â–∞–µ—Ç —É—Å–ª–æ–≤–∏—è
- –í–ª–æ–∂–µ–Ω–Ω—ã–µ condition chains ‚Üí –ø—Ä—è–º—ã–µ jumps
- –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è

### 4. –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—ã
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä—É–µ—Ç condition+JMP –ø–∞—Ä—ã
- –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç jump offsets

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

‚úÖ **96.1% LOOPs —É–¥–∞–ª–µ–Ω–æ** (1059 –∏–∑ 1102)  
‚úÖ **88.6% –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π —É–¥–∞–ª–µ–Ω–æ** (93,129 –∏–∑ 105,115)  
‚úÖ **73% —É–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞**

## –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ

‚ö†Ô∏è **–ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∂–µ—Ä—Ç–≤—É—é—Ç —Ç–æ—á–Ω–æ—Å—Ç—å—é —Ä–∞–¥–∏ –¥–µ–∫–æ–º–ø–∏–ª—è—Ü–∏–∏!**

–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: **–¥–µ–∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º–æ—Å—Ç—å > —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã**

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `AGGRESSIVE_README.md` - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `TEST_RESULTS.md` - –¥–µ—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- `compare_cleaners.py` - —É—Ç–∏–ª–∏—Ç–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.6+
- –ù–µ—Ç –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (—Ç–æ–ª—å–∫–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞)

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–°–æ–∑–¥–∞–Ω–æ –¥–ª—è –ø—Ä–µ–æ–¥–æ–ª–µ–Ω–∏—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π decompiler –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å 
MoonSec V3 –æ–±—Ñ—É—Å–∫–∞—Ü–∏–µ–π.
